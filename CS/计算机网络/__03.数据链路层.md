<!--
 * _______________#########_______________________ 
 * ______________############_____________________ 
 * ______________#############____________________ 
 * _____________##__###########___________________ 
 * ____________###__######_#####__________________ 
 * ____________###_#######___####_________________ 
 * ___________###__##########_####________________ 
 * __________####__###########_####_______________ 
 * ________#####___###########__#####_____________ 
 * _______######___###_########___#####___________ 
 * _______#####___###___########___######_________ 
 * ______######___###__###########___######_______ 
 * _____######___####_##############__######______ 
 * ____#######__#####################_#######_____ 
 * ____#######__##############################____ 
 * ___#######__######_#################_#######___ 
 * ___#######__######_######_#########___######___ 
 * ___#######____##__######___######_____######___ 
 * ___#######________######____#####_____#####____ 
 * ____######________#####_____#####_____####_____ 
 * _____#####________####______#####_____###______ 
 * ______#####______;###________###______#________ 
 * ________##_______####________####______________ 
 * 
 * @Author: 崩布猪
 * @Date: 2024-03-18 15:54:44
 * @LastEditors: 崩布猪
 * @LastEditTime: 2024-04-01 15:20:39
 * @FilePath: \课业\计算机网络\__03.数据链路层.md
 * @Description: 
 * 本章主要讲述数据链路层
 * 
 -->
# 数据链路层
两种类型
  - 点对点
  - 广播信道 
    - 使用共享信道协议来协调这些主机的数据发送
 
数据链路层的地位：网络中的主机、路由器等都必须实现数据链路层
## 数据链路层的几个共同问题

数据链路和帧/物理链路
  - 链路
    - 一条无源的点到点的物理路段，中间没有任何其他的交换节点
    - 一条链路只是一条通路的一个组成部分    
  - 数据链路/逻辑链路
    - 把实现控制数据传输的协议的硬件和软件加到链路上
    - 例子 网卡（适配器）
帧
    - 数据链路层的协议数据单元
- 三个基本问题
  - 封装成帧
    - 在一段数据的前后分别添加首部和尾部，构成一个帧
    - 首部和尾部的作用（重要的）是进行<b>帧定界</b>
    - 最大传送单元
      - 每一种链路层协议都规定了所能传送的帧的数据部分长度上限
    - 用控制字符作为帧定界符
      - SOH 帧前
      - EOT 帧尾
  - 透明传输
    - 某一个时间存在的事物看起来却好像不存在一样
    - 字节填充/字符填充
      - 在数据中的soh或者eot 字符面前插入一个转义字符 esc
  - 差错检测
    - 显示的通信链路都不会是理想的 
    - 比特差错 
      - 传输过程中1 变成 0 或者 0 变成 1
    - 循环沉余校验 方法
      - CRC 冗余码运算
        - 冗余码
          - 原始数据 M =101001
          -  P（除数）
             -   = 1101 =x<sup>3</sup>+x<sup>2</sup>+1
             -  另一种方法
             -   x<sup>4</sup> + x<sup>3</sup> +x<sup>2</sup> +x+1  == 写系数 11111  
         - 发送数据 101001 001
    - 可靠传输
      - 给帧加上帧编号、确认、重传等机制 --针对通信质量比较差的传输
    - 传输差错
      - 比特差错
      - 传输差错
## 点对点协议 PPP
- 1994年成为正式标准
- 应满足的要求
  - 简单 --首选要求
  - 封装成帧
  - 透明性
  - 多种网络层协议
  - 多种类型链路
  - 差错检测
  - 检测连接状态
  - 最大传送单元
  - 网络层地址协商
  - 数据压缩协商
- 组成
  - 一个将ip数据报封装到串行链路的方法
  - 一个用来建立、配置和测试数据链路连接的链路控制协议LCP
  - 一套网络控制协议NCP
- PPP协议的帧格式
  - 各字段的意义
    - 首部四个字节
    - 标志字段F ：0x7e 连续两帧之间只需要用一个比总之字段
    - 地址字段A ：0xff
    - 控制字段C ：0x03 
    - 协议字段：
  - 字节填充
    - 当信息字段出现和标志字段一样的比特组合时，必须采用一些措施避免
    - 字节填充方法
      - 把信息段出现的每一个0x7E字节转变成2字节序列0x7D,0x5E
      - 每出现
      - 啊
- PPP协议的工作状态
  - 初始化过程

## 使用广播信道的数据链路层

### 局域网的数据链路层
局域网的主要特点
- 一个单位所拥有
- 地理方位和站点数目均有限  

优点：
- 广播功能
- 便于系统的扩展和逐渐地演变
- 提高了系统的可靠性  

分类：
- 星形网 
- 环状网
- 总线网  

媒体共享技术  
静态划分信道
- 频分复用
- 时分复用
- 波分复用
- 码分复用
- 
动态媒体接入可控制(多点接入)
- 随机接入
- 受控接入

以太网的两个标准
- 802.4 802.5 
- 指定这个协议的协会吧局域网的数据链路层拆成两个子层
  - LLC 逻辑链路控制
  - MAC 媒体接入控制

适配器(网卡)的作用
- 串行并行的转换
- 对数据进行缓存
- 在计算机的操作系统安装设备驱动程序
- 实现以太网协议

### CSMA/CD协议
最早的以太网： 将许多极端及都连接到一根总线上
总线的特点 
为了通信的渐变，以太网采取的措施
- 采用较为灵活的无连接的工作方式
- 以太网发送的数据使用曼切斯特编码的信号

### 使用集线器的星型拓补

### 以太网的信息利用率
成功发送一个帧占用信道的时间

### 以太网的MAC层
#### 硬件地址 又称为 物理地址 or MAC地址（因为地址用在MAC帧中）
- 名字指出我们所要寻找的那个资源，地址指出那个资源在何处，路由告诉我们如何到达该处。
- 48位MAC地址
  - IEEE的注册管理机构RA 分配  地址字段的6个字节中的前三个字节（OUI）
  - 后三个字节（扩展标识符） 厂家自己分配 
  - 成产网卡的时候 该地址固化在网卡当中。
  - I/G 位 地址段的第一个字节的最低有效位 0 - 单个站地址 1- 组地址
  - G/L 位 地址段第一个字节的最低第二位 0 - 全球管理 1- 本地管理
- 适配器（网卡）的过滤功能
  - 没有到一个MAC帧，先用硬件检查帧中的MAC地址
  - 如果是发送本站的帧 收下 然后在进行其他的处理 否则 丢弃此帧并不做其他处理
    - 发送本站的帧包括
      - 单播帧 (一对一)
      - 广播帧 (一对全体)
      - 多播帧 (一对多)
      - 只有目的地址才会用到广播地址和多播地址
    - 特殊的工作方式 混合模式
      - 只要听到有帧就会在以太网上传输 就会都接受下来
      - 会被黑客利用
#### MAC帧的格式
- 标准
  - V2
  - 802.3

V2：
组成
  - 6字节 的 目的地址
  - 6字节 的 源地址
  - 2字节 的 类型字段
  - 46-1500。字节 的 数据字段
  - 4字节 的 帧检验序列FCS(使用CRC检验)
- 当数据总长度不够时 会 添加 填充字段 到 46字节 数据上交ip层后 会丢弃传输字段
- MAC子层 下传到 物理层时 会在帧前面插入8个字节
  - 7字节 的 前同步码(0和1的交替码) 
  - 1字节 的 帧开始定界符

802.3
组成：
  - 基本同上
  - 不同点
  - 类型字段 变成 长度/类型 字段 字段 > 0x0600 时 表示 类型 < 时 表示长度 并且 必须装入上面的逻辑链路控制LLC子层的 LLC帧

#### 扩展以太网
- 物理层上扩展以太网
  - 使用光纤 和 光纤调制解调器 简单方便
  - 多个集线器连接成更大的以太网
    - 优点 使用原理属于不同碰撞域的计算机能够 跨碰撞域通信
    - 扩大了以太网覆盖的地理方位
      - 碰撞域 网络中一个站点发出的帧 会与 其他站点发出的帧 产生碰撞or冲突 的部分网络
    - 缺点
      - 碰撞域增大了，总的吞吐两没有提高
      - 如果使用的时不同的以太网技术，那就连接不起来
- 在数据链路层扩展以太网 （经常性）
  - 网桥
    - 工作在数据链路层
  - 交换机
    - 特点 
      - 本质上是一个多端口的网桥
      - 一般工作在全双工方式
      - 地址表时通过自学习算法自动地建立起来了
      - 由存储器
      - 即插即用
- 从总线以太网到星星以太网
- 

### 虚拟局域网
- 广播风暴
  - 广播域 其中任何一台设备发出的广播通信都能被该部分网络中的所有其他设备所接收
  - 一个以太网时一个广播域
  - 当广播域中产生了大量的广播帧后 如果 发生的广播帧在网络中无限制的兜圈子，就形成了网络风暴导致网络瘫痪
- 虚拟局域网
  - 背景: 一个单位的以太网 往往时几个下属部门使用，会对网络信息安全不利。所以需要每个部门都有一个小的局域网，虚拟局域网技术会把一个大的局域网分成一些小的局域网
  - 定义:802.1.Q标准 它是由一些局域网段构成的 与物理位置无关的 逻辑组，这些网段具有某些共同的要求。每一个VLAN的帧都有一个明确的标识符，指明发送这个帧的计算机时属于哪一个VLAN
  - 它只是局域网给用户 的 一种服务 并不是一种新型局域网
  - 优点
    - 改善了性能
    - 简化了管理
    - 降低了成本
    - 改善了安全性
  - 划分方法
    - 基于交换机端口方法 简单常用 不能移动 1层划分
    - 基于mac划分 第二层划分 允许用户移动 mac地址改变后需要重新分配
    - 基于IP子网地址的方法 第三层划分 源IP地址确定IP分组属于哪一个虚拟局域网。
### 告诉以太网
- 100BASE-T 以太网
- 吉比特以太网
- 10吉比特以太网
-  